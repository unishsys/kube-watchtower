import{j as q}from"./QPage.368960c7.js";import{c as C,r as d,a as E,az as M,y as V,m as B,h as i,l as x,a5 as y}from"./index.e96496b9.js";function f(e,l=new WeakMap){if(Object(e)!==e)return e;if(l.has(e))return l.get(e);const n=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const t=e.valueOf();if(Object(t)!==t){const u=new e.constructor(t);return l.set(e,u),u}}return l.set(e,n),e instanceof Set?e.forEach(t=>{n.add(f(t,l))}):e instanceof Map&&e.forEach((t,u)=>{n.set(u,f(t,l))}),Object.assign(n,...Object.keys(e).map(t=>({[t]:f(e[t],l)})))}var Q=C({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:l,emit:n}){const{proxy:t}=x(),{$q:u}=t,a=d(null),r=d(""),o=d("");let v=!1;const S=E(()=>M({initialValue:r.value,validate:e.validate,set:b,cancel:s,updatePosition:g},"value",()=>o.value,c=>{o.value=c}));function b(){e.validate(o.value)!==!1&&(p()===!0&&(n("save",o.value,r.value),n("update:modelValue",o.value)),w())}function s(){p()===!0&&n("cancel",o.value,r.value),w()}function g(){V(()=>{a.value.updatePosition()})}function p(){return B(o.value,r.value)===!1}function w(){v=!0,a.value.hide()}function m(){v=!1,r.value=f(e.modelValue),o.value=f(e.modelValue),n("beforeShow")}function h(){n("show")}function j(){v===!1&&p()===!0&&(e.autoSave===!0&&e.validate(o.value)===!0?(n("save",o.value,r.value),n("update:modelValue",o.value)):n("cancel",o.value,r.value)),n("beforeHide")}function O(){n("hide")}function _(){const c=l.default!==void 0?[].concat(l.default(S.value)):[];return e.title&&c.unshift(i("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&c.push(i("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[i(y,{flat:!0,color:e.color,label:e.labelCancel||u.lang.label.cancel,onClick:s}),i(y,{flat:!0,color:e.color,label:e.labelSet||u.lang.label.set,onClick:b})])),c}return Object.assign(t,{set:b,cancel:s,show(c){a.value!==null&&a.value.show(c)},hide(c){a.value!==null&&a.value.hide(c)},updatePosition:g}),()=>{if(e.disable!==!0)return i(q,{ref:a,class:"q-popup-edit",cover:e.cover,onBeforeShow:m,onShow:h,onBeforeHide:j,onHide:O,onEscapeKey:s},_)}}}),D=(e,l)=>{const n=e.__vccOpts||e;for(const[t,u]of l)n[t]=u;return n};export{Q,D as _};
