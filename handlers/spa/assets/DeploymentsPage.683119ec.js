import{r,f as ae,P as g,$ as N,U as a,T as s,aS as H,a3 as oe,aT as J,aU as V,V as n,a2 as u,a0 as $,a1 as p,aV as le,w as A,ah as i,S as T,aW as I,aX as se,aY as ne,aZ as w,a_ as L,Q as P,a$ as re,b0 as ie}from"./index.411b9c00.js";import{_ as de,Q as ce,a as ue,b as U,c as pe,C as z}from"./plugin-vue_export-helper.19ffcc6b.js";import{Q as me,b as fe}from"./QPage.815aec40.js";import{Q as ve,a as ge,b as _}from"./QTable.4b4b5685.js";import{api as h}from"./axios.6090f508.js";import{u as ye}from"./use-quasar.4e24346d.js";import{V as _e}from"./theme-tomorrow_night.15c3a2c5.js";import"./rtl.b51694b1.js";const he=k=>(re("data-v-13aab856"),k=k(),ie(),k),be={class:"text-h6"},we=he(()=>n("div",{class:"text-h6"},"Response",-1)),ke=["innerHTML"],Ce={style:{"margin-left":"4%","margin-right":"4%","margin-top":"2%"}},xe={class:"full-width row wrap justify-start items-start content-stretch"},Ve={class:"col-6"},$e={class:"q-mb-md q-pr-xl q-pt-xl"},Te={class:"neubutton"},Qe={key:0},Se={key:1},De={class:"row"},qe={class:"text-center"},Ne={class:"q-ma-xl col-6 absolute-right"},Ae={class:"row text-h5 text-weight-light q-mb-md",style:{"margin-left":"15%"}},Ie={class:"q-ml-md text-weight-bold"},Pe={class:"row q-pa-md q-gutter-sm"},Ue={__name:"DeploymentsPage",setup(k){const m=ye(),E=r([]),d=r(null),C=r(null),R=r([]),Q=r(!1),c=r(""),y=r(null),b=r(!1),f=r(!1);let S="",M="";function W(){h.get("/api/v1/get-namespaces").then(o=>{R.value=o.data.data})}function D(){d.value&&h.get(`/api/v1/deploy/${d.value}`).then(o=>{let t=o.data.data;t.forEach(e=>{delete e.labels}),E.value=t}).catch(o=>{m.notify({color:"error",position:"top-right",message:o.message,icon:"report_problem"})})}function Y(o){const t=parseInt(o.replicas,10);h.post("/api/v1/deploy/",{namespace:d.value,name:o.name,replicas:t}).then(e=>{let l=e.data;m.notify({color:l.status,position:"top-right",message:l.msg+" -> "+o.replicas,icon:"done"}),setTimeout(()=>{D()},3e3)}).catch(e=>{m.notify({color:"error",position:"top-right",message:e.message,icon:"report_problem"})})}function F(o){h.get(`/api/v1/deploy/${d.value}/${o.name}/yaml`).then(t=>{c.value=t.data.data,C.value=o.name}).catch(t=>{m.notify({color:"error",position:"top-right",message:t.message,icon:"report_problem"})})}function X(){console.log(c.value),h.post(`/api/v1/deploy/${d.value}/${C.value}/yaml`,{data:c.value},{headers:{"Content-Type":"application/json"}}).then(o=>{c.value=o.data.data,m.notify({progress:!0,color:o.data.status,position:"top-right",message:o.data.msg,icon:"done"}),setTimeout(()=>{D()},3e3)}).catch(o=>{m.notify({color:"error",position:"top-right",message:o.message,icon:"report_problem"})})}function B(o){h.get(`/api/v1/deploy/${d.value}/${o.name}`).then(t=>{const e=t.data;S=Z(e)}).catch(t=>{m.notify({color:"error",position:"top-right",message:t.message,icon:"report_problem"})}).finally(()=>{Q.value=!0})}function Z(o){let t="";for(const e of o.data){M=e.name;for(const l of e.status)l.ready||(t+=`${l.name} container state is not ready because of ${l.state.waiting.reason}: ${l.state.waiting.message}.`)}return t===""&&(t="All containers are in a ready state."),t.trim()}async function G(){let o=`you are an kubernetes expert you know all about Kubernetes best practices and security, also you know web development. for a given kubernetes deployment manifest you will provide the missing best practices in the manifest with proper examples and explanation, try to keep them as concise as possible in htlm format use <pre></pre> tag for all your respose, do not use title or heading:
---
${c.value}`;const t=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"codellama",prompt:o})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);y.value="",b.value=!0;const e=t.body.getReader(),l=async()=>{const{done:v,value:q}=await e.read();if(v){console.log("stream done");return}const K=new TextDecoder("utf-8").decode(q),x=JSON.parse(K);console.log(x.response),y.value+=x.response,l()};l()}function ee(){y.value=null,b.value=!1}async function te(o){let t=`you are an kubernetes and devops expert. for a given kubernetes error message, you will provide most possible debugging points try to keep them as concise as possible in htlm format use <pre></pre> tag for all your respose, do not use title or heading:
---
${o}`;const e=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"codellama",prompt:t})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);y.value="",b.value=!0;const l=e.body.getReader(),v=async()=>{const{done:q,value:O}=await l.read();if(q){console.log("stream done");return}const x=new TextDecoder("utf-8").decode(O),j=JSON.parse(x);console.log(j.response),y.value+=j.response,v()};v()}return ae(W),(o,t)=>(g(),N(oe,null,[a(H,{modelValue:Q.value,"onUpdate:modelValue":t[1]||(t[1]=e=>Q.value=e)},{default:s(()=>[a(J,null,{default:s(()=>[a(V,null,{default:s(()=>[n("div",be,"Pod: "+u($(M)),1)]),_:1}),a(V,{class:"q-pt-none"},{default:s(()=>[p(u($(S)),1)]),_:1}),a(le,{align:"right"},{default:s(()=>[A(a(i,{flat:"",label:"OK",color:"primary"},null,512),[[z]]),A(a(i,{flat:"",label:"Ask AI?",color:"secondary",onClick:t[0]||(t[0]=e=>te($(S)))},null,512),[[z]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(H,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e),persistent:"",maximized:f.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:s(()=>[a(J,{class:"bg-primary--dark"},{default:s(()=>[a(ce,null,{default:s(()=>[a(ue),a(i,{dense:"",flat:"",icon:"minimize",onClick:t[2]||(t[2]=e=>f.value=!1),disable:!f.value},{default:s(()=>[f.value?I("",!0):(g(),T(U,{key:0,class:"bg-white text-primary"},{default:s(()=>[p("Maximize")]),_:1}))]),_:1},8,["disable"]),a(i,{dense:"",flat:"",icon:"crop_square",onClick:t[3]||(t[3]=e=>f.value=!0),disable:f.value},{default:s(()=>[f.value?(g(),T(U,{key:0,class:"bg-white text-primary"},{default:s(()=>[p("Minimize")]),_:1})):I("",!0)]),_:1},8,["disable"]),A((g(),T(i,{dense:"",flat:"",icon:"close",onClick:ee},{default:s(()=>[a(U,{class:"bg-white text-primary"},{default:s(()=>[p("Close")]),_:1})]),_:1})),[[z]])]),_:1}),a(V,null,{default:s(()=>[we]),_:1}),a(V,{class:"q-pt-none"},{default:s(()=>[n("div",{innerHTML:y.value},null,8,ke)]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),a(me,null,{default:s(()=>[n("div",Ce,[n("div",xe,[n("div",Ve,[n("div",$e,[a(fe,{modelValue:d.value,"onUpdate:modelValue":[t[5]||(t[5]=e=>d.value=e),D],options:R.value,label:"Select Namespace"},null,8,["modelValue","options"])]),a(ve,{flat:"",bordered:"",title:"Deploy",rows:E.value,"row-key":"name"},{body:s(e=>[a(ge,{props:e},{default:s(()=>[a(_,{key:"name",props:e},{default:s(()=>[p(u(e.row.name),1)]),_:2},1032,["props"]),a(_,{key:"replicas",props:e},{default:s(()=>[n("div",Te,u(e.row.replicas),1),a(pe,{modelValue:e.row.replicas,"onUpdate:modelValue":l=>e.row.replicas=l,title:"Update Replica"},{default:s(l=>[a(se,{modelValue:l.value,"onUpdate:modelValue":v=>l.value=v,dense:"",autofocus:"",onKeyup:ne(l.set,["enter"]),hint:"Replica Count"},{after:s(()=>[a(i,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:w(l.cancel,["stop","prevent"])},null,8,["onClick"]),a(i,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:[w(l.set,["stop","prevent"]),v=>Y(e.row)],disable:l.validate(l.value)===!1||l.initialValue===l.value},null,8,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(_,{key:"availableReplicas",props:e},{default:s(()=>[p(u(e.row.availableReplicas),1)]),_:2},1032,["props"]),a(_,{key:"readyReplicas",props:e},{default:s(()=>[p(u(e.row.readyReplicas),1)]),_:2},1032,["props"]),a(_,{key:"status",props:e,class:L(e.row.status),style:{"align-content":"center"}},{default:s(()=>[e.row.status==="success"?(g(),N("div",Qe,[a(P,{name:"check_circle",size:"2em",color:"green-12",onClick:w(l=>B(e.row),["stop"])},null,8,["onClick"])])):(g(),N("div",Se,[a(P,{name:"error",size:"2em",color:"red-12",clickable:"",onClick:w(l=>B(e.row),["stop"])},null,8,["onClick"])]))]),_:2},1032,["props","class"]),a(_,{key:"createdAt",props:e,class:L(e.row.createdAt)},{default:s(()=>[n("div",De,[n("div",qe,u(e.row.createdAt.split("T")[0]),1),a(P,{name:"edit_square",size:"2em",color:"yellow-2",onClick:w(l=>F(e.row),["stop"])},null,8,["onClick"])])]),_:2},1032,["props","class"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),n("div",Ne,[n("div",null,[n("div",Ae,[p("Editing "),n("span",Ie,u(C.value),1)]),a($(_e),{style:{"margin-left":"15%"},value:c.value,"onUpdate:value":t[6]||(t[6]=e=>c.value=e),lang:"yaml",theme:"tomorrow_night",options:{autoScrollEditorIntoView:!0,copyWithEmptySelection:!0,fontSize:15,minLines:30,maxLines:50}},null,8,["value"])]),n("div",Pe,[a(i,{style:{"margin-left":"15%"},color:"secondary",label:"Update Deployment",clickable:"",onClick:t[7]||(t[7]=e=>X())}),c.value&&C.value?(g(),T(i,{key:0,style:{"margin-left":"15%"},color:"blue-14",label:"Ask AI?",clickable:"",onClick:t[8]||(t[8]=e=>G())})):I("",!0)])])])])]),_:1})],64))}};var He=de(Ue,[["__scopeId","data-v-13aab856"]]);export{He as default};
