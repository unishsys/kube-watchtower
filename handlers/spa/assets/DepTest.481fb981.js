import{r,f as ae,P as g,$ as A,U as a,T as s,aS as H,a3 as oe,aT as J,aU as T,V as n,a2 as u,a0 as V,a1 as p,aV as le,w as N,ah as i,S as $,aW as I,aX as se,aY as ne,aZ as k,a_ as K,Q as U,a$ as re,b0 as ie}from"./index.0b8848cf.js";import{_ as de,Q as ce,a as ue,b as z,c as pe,C as E}from"./plugin-vue_export-helper.ae062b1a.js";import{Q as me,b as fe}from"./QPage.cdf6597f.js";import{Q as ve,a as ge,b as _}from"./QTable.0d808499.js";import{api as h}from"./axios.f91f11ce.js";import{u as ye}from"./use-quasar.4db0a28a.js";import{V as _e}from"./theme-tomorrow_night.64bd13b3.js";import"./rtl.b51694b1.js";const he=w=>(re("data-v-38e52998"),w=w(),ie(),w),be={class:"text-h6"},ke=he(()=>n("div",{class:"text-h6"},"Response",-1)),we=["innerHTML"],Ce={style:{"margin-left":"4%","margin-right":"4%","margin-top":"2%"}},xe={class:"full-width row wrap justify-start items-start content-stretch"},Te={class:"col-6"},Ve={class:"q-mb-md q-pr-xl q-pt-xl"},$e={class:"neubutton"},Qe={key:0},Se={key:1},De={class:"row"},qe={class:"text-center"},Ae={class:"q-ma-xl col-6 absolute-right"},Ne={class:"row text-h5 text-weight-light q-mb-md",style:{"margin-left":"15%"}},Ie={class:"q-ml-md text-weight-bold"},Ue={class:"row q-pa-md q-gutter-sm"},ze={__name:"DepTest",setup(w){const m=ye(),M=r([]),d=r(null),C=r(null),R=r([]),Q=r(!1),c=r(""),y=r(null),b=r(!1),f=r(!1);let S="",P="";function Y(){h.get("/api/v1/get-namespaces").then(o=>{R.value=o.data.data})}function D(){d.value&&h.get(`/api/v1/deploy/${d.value}`).then(o=>{let t=o.data.data;t.forEach(e=>{delete e.labels}),M.value=t}).catch(o=>{m.notify({color:"error",position:"top-right",message:o.message,icon:"report_problem"})})}function W(o){const t=parseInt(o.replicas,10);h.post("/api/v1/deploy/",{namespace:d.value,name:o.name,replicas:t}).then(e=>{let l=e.data;m.notify({color:l.status,position:"top-right",message:l.msg+" -> "+o.replicas,icon:"done"}),setTimeout(()=>{D()},3e3)}).catch(e=>{m.notify({color:"error",position:"top-right",message:e.message,icon:"report_problem"})})}function F(o){h.get(`/api/v1/deploy/${d.value}/${o.name}/yaml`).then(t=>{c.value=t.data.data,C.value=o.name}).catch(t=>{m.notify({color:"error",position:"top-right",message:t.message,icon:"report_problem"})})}function X(){console.log(c.value),h.post(`/api/v1/deploy/${d.value}/${C.value}/yaml`,{data:c.value},{headers:{"Content-Type":"application/json"}}).then(o=>{c.value=o.data.data,m.notify({progress:!0,color:o.data.status,position:"top-right",message:o.data.msg,icon:"done"}),setTimeout(()=>{D()},3e3)}).catch(o=>{m.notify({color:"error",position:"top-right",message:o.message,icon:"report_problem"})})}function B(o){h.get(`/api/v1/deploy/${d.value}/${o.name}`).then(t=>{const e=t.data;S=Z(e)}).catch(t=>{m.notify({color:"error",position:"top-right",message:t.message,icon:"report_problem"})}).finally(()=>{Q.value=!0})}function Z(o){let t="";for(const e of o.data){P=e.name;for(const l of e.status)l.ready||(t+=`${l.name} container state is not ready because of ${l.state.waiting.reason}: ${l.state.waiting.message}.`)}return t===""&&(t="All containers are in a ready state."),t.trim()}async function G(){let o=`you are an kubernetes and devops expert. for a given kubernetes deployment manifest in YAML format, you will provide only the missing best practices in htlm format use for code use pre tag and for text use p tag :
---
${c.value}`;const t=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"mistral",prompt:o})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);y.value="",b.value=!0;const e=t.body.getReader(),l=async()=>{const{done:v,value:q}=await e.read();if(v){console.log("stream done");return}const L=new TextDecoder("utf-8").decode(q),x=JSON.parse(L);console.log(x.response),y.value+=x.response,l()};l()}function ee(){y.value=null,b.value=!1}async function te(o){let t=`you are an kubernetes and devops expert. for a given kubernetes error message, you will provide most possible debugging points try to keep them as concise as possible in htlm format use for code use pre tag and for text use p tag :
---
${o}`;const e=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"mistral",prompt:t})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);y.value="",b.value=!0;const l=e.body.getReader(),v=async()=>{const{done:q,value:O}=await l.read();if(q){console.log("stream done");return}const x=new TextDecoder("utf-8").decode(O),j=JSON.parse(x);console.log(j.response),y.value+=j.response,v()};v()}return ae(Y),(o,t)=>(g(),A(oe,null,[a(H,{modelValue:Q.value,"onUpdate:modelValue":t[1]||(t[1]=e=>Q.value=e)},{default:s(()=>[a(J,null,{default:s(()=>[a(T,null,{default:s(()=>[n("div",be,"Pod: "+u(V(P)),1)]),_:1}),a(T,{class:"q-pt-none"},{default:s(()=>[p(u(V(S)),1)]),_:1}),a(le,{align:"right"},{default:s(()=>[N(a(i,{flat:"",label:"OK",color:"primary"},null,512),[[E]]),N(a(i,{flat:"",label:"Ask AI?",color:"secondary",onClick:t[0]||(t[0]=e=>te(V(S)))},null,512),[[E]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(H,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e),persistent:"",maximized:f.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:s(()=>[a(J,{class:"bg-primary--dark"},{default:s(()=>[a(ce,null,{default:s(()=>[a(ue),a(i,{dense:"",flat:"",icon:"minimize",onClick:t[2]||(t[2]=e=>f.value=!1),disable:!f.value},{default:s(()=>[f.value?I("",!0):(g(),$(z,{key:0,class:"bg-white text-primary"},{default:s(()=>[p("Maximize")]),_:1}))]),_:1},8,["disable"]),a(i,{dense:"",flat:"",icon:"crop_square",onClick:t[3]||(t[3]=e=>f.value=!0),disable:f.value},{default:s(()=>[f.value?(g(),$(z,{key:0,class:"bg-white text-primary"},{default:s(()=>[p("Minimize")]),_:1})):I("",!0)]),_:1},8,["disable"]),N((g(),$(i,{dense:"",flat:"",icon:"close",onClick:ee},{default:s(()=>[a(z,{class:"bg-white text-primary"},{default:s(()=>[p("Close")]),_:1})]),_:1})),[[E]])]),_:1}),a(T,null,{default:s(()=>[ke]),_:1}),a(T,{class:"q-pt-none"},{default:s(()=>[n("div",{innerHTML:y.value},null,8,we)]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),a(me,null,{default:s(()=>[n("div",Ce,[n("div",xe,[n("div",Te,[n("div",Ve,[a(fe,{modelValue:d.value,"onUpdate:modelValue":[t[5]||(t[5]=e=>d.value=e),D],options:R.value,label:"Select Namespace"},null,8,["modelValue","options"])]),a(ve,{flat:"",bordered:"",title:"Deploy",rows:M.value,"row-key":"name"},{body:s(e=>[a(ge,{props:e},{default:s(()=>[a(_,{key:"name",props:e},{default:s(()=>[p(u(e.row.name),1)]),_:2},1032,["props"]),a(_,{key:"replicas",props:e},{default:s(()=>[n("div",$e,u(e.row.replicas),1),a(pe,{modelValue:e.row.replicas,"onUpdate:modelValue":l=>e.row.replicas=l,title:"Update Replica"},{default:s(l=>[a(se,{modelValue:l.value,"onUpdate:modelValue":v=>l.value=v,dense:"",autofocus:"",onKeyup:ne(l.set,["enter"]),hint:"Replica Count"},{after:s(()=>[a(i,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:k(l.cancel,["stop","prevent"])},null,8,["onClick"]),a(i,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:[k(l.set,["stop","prevent"]),v=>W(e.row)],disable:l.validate(l.value)===!1||l.initialValue===l.value},null,8,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(_,{key:"availableReplicas",props:e},{default:s(()=>[p(u(e.row.availableReplicas),1)]),_:2},1032,["props"]),a(_,{key:"readyReplicas",props:e},{default:s(()=>[p(u(e.row.readyReplicas),1)]),_:2},1032,["props"]),a(_,{key:"status",props:e,class:K(e.row.status),style:{"align-content":"center"}},{default:s(()=>[e.row.status==="success"?(g(),A("div",Qe,[a(U,{name:"check_circle",size:"2em",color:"green-12",onClick:k(l=>B(e.row),["stop"])},null,8,["onClick"])])):(g(),A("div",Se,[a(U,{name:"error",size:"2em",color:"red-12",clickable:"",onClick:k(l=>B(e.row),["stop"])},null,8,["onClick"])]))]),_:2},1032,["props","class"]),a(_,{key:"createdAt",props:e,class:K(e.row.createdAt)},{default:s(()=>[n("div",De,[n("div",qe,u(e.row.createdAt.split("T")[0]),1),a(U,{name:"edit_square",size:"2em",color:"yellow-2",onClick:k(l=>F(e.row),["stop"])},null,8,["onClick"])])]),_:2},1032,["props","class"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),n("div",Ae,[n("div",null,[n("div",Ne,[p("Editing "),n("span",Ie,u(C.value),1)]),a(V(_e),{style:{"margin-left":"15%"},value:c.value,"onUpdate:value":t[6]||(t[6]=e=>c.value=e),lang:"yaml",theme:"tomorrow_night",options:{autoScrollEditorIntoView:!0,copyWithEmptySelection:!0,fontSize:15,minLines:30,maxLines:50}},null,8,["value"])]),n("div",Ue,[a(i,{style:{"margin-left":"15%"},color:"secondary",label:"Update Deployment",clickable:"",onClick:t[7]||(t[7]=e=>X())}),c.value&&C.value?(g(),$(i,{key:0,style:{"margin-left":"15%"},color:"blue-14",label:"Ask AI?",clickable:"",onClick:t[8]||(t[8]=e=>G())})):I("",!0)])])])])]),_:1})],64))}};var He=de(ze,[["__scopeId","data-v-38e52998"]]);export{He as default};
