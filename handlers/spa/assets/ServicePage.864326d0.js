import{a as T,b as y}from"./QPage.7a149ef6.js";import{r as d,f as q,P as n,S as N,T as s,U as l,X as U,a2 as m,b1 as c,aa as w,_ as g,W as u,a7 as i}from"./index.a59d4d52.js";import{Q as C,a as D,b as p}from"./QTable.415bb91f.js";import{Q as B}from"./QForm.ef233581.js";import{api as v}from"./axios.e0fa00c7.js";import{u as $}from"./use-quasar.b9a1d46b.js";const R={class:"row q-gutter-md"},z={key:0},A={key:0,class:"row q-gutter-md"},F={key:1,class:"row q-gutter-md"},E={key:2,class:"row q-gutter-md"},L={key:3},O={__name:"ServicePage",setup(M){const r=$(),b=d([]),V=d([]),P=d([]),_=d([]),k=["TCP","UDP"],h=["NodePort","LoadBalancer","ClusterIP"],e=d({name:null,namespace:null,labels:{app:null},containerPort:null,servicePort:null,protocol:"TCP",selector:{app:null},type:null});function x(){v.get("/api/v1/get-namespaces").then(a=>{V.value=a.data.data})}function f(){v.get(`/api/v1/deploy/${e.value.namespace}`).then(a=>{b.value=a.data.data.map(o=>o.name),P.value=a.data.data}).catch(a=>{r.notify({color:"error",position:"top-right",message:a.message,icon:"report_problem"})}),v.get(`/api/v1/svc/${e.value.namespace}`).then(a=>{_.value=a.data.data}).catch(a=>{r.notify({color:"error",position:"top-right",message:a.message,icon:"report_problem"})})}function S(a){console.log("Delete clicked for row:",a),v.delete(`/api/v1/svc/${e.value.namespace}/${a.name}`).then(o=>{r.notify({color:"success",position:"top-right",message:"Service Deleted: "+a.name,icon:"done"}),setInterval(()=>{f()},1e3)}).catch(o=>{r.notify({color:"error",position:"top-right",message:o.message,icon:"report_problem"})})}function Q(){e.value={}}function I(){const a=P.value.find(o=>o.name===e.value.name);e.value.labels=a.labels,e.value.selector=a.labels,e.value.containerPort=parseInt(e.value.containerPort,10),e.value.servicePort=parseInt(e.value.servicePort,10),v.post("/api/v1/svc/",e.value).then(o=>{r.notify({color:o.data.status,position:"top-right",message:o.data.msg+": "+o.data.data.metadata.name,icon:"done"}),setInterval(()=>{f()},1e3)}).catch(o=>{r.notify({color:"error",position:"top-right",message:o.message,icon:"report_problem"})})}return q(x),(a,o)=>(n(),N(T,{class:"flex flex-center"},{default:s(()=>[l(B,{modelValue:e.value,"onUpdate:modelValue":o[6]||(o[6]=t=>e.value=t),onSubmit:I,onReset:Q,class:"q-gutter-md"},{default:s(()=>[U("div",R,[l(y,{modelValue:e.value.namespace,"onUpdate:modelValue":[o[0]||(o[0]=t=>e.value.namespace=t),f],options:V.value,label:"Select Namespace",filled:"",style:{width:"180px"}},null,8,["modelValue","options"]),e.value.namespace?(n(),m("div",z,[l(y,{modelValue:e.value.name,"onUpdate:modelValue":o[1]||(o[1]=t=>e.value.name=t),options:b.value,label:"Select Deployment",filled:"",style:{width:"180px"}},null,8,["modelValue","options"])])):c("",!0)]),e.value.name?(n(),m("div",A,[l(w,{filled:"",type:"number",modelValue:e.value.containerPort,"onUpdate:modelValue":o[2]||(o[2]=t=>e.value.containerPort=t),label:"Container Port *","lazy-rules":"",style:{width:"180px"}},null,8,["modelValue"]),l(w,{filled:"",type:"number",modelValue:e.value.servicePort,"onUpdate:modelValue":o[3]||(o[3]=t=>e.value.servicePort=t),label:"Service Port *","lazy-rules":"",style:{width:"180px"}},null,8,["modelValue"])])):c("",!0),e.value.containerPort&&e.value.servicePort?(n(),m("div",F,[l(y,{options:k,modelValue:e.value.protocol,"onUpdate:modelValue":o[4]||(o[4]=t=>e.value.protocol=t),label:"Service Protocol",filled:"",style:{width:"180px"}},null,8,["modelValue"]),l(y,{options:h,modelValue:e.value.type,"onUpdate:modelValue":o[5]||(o[5]=t=>e.value.type=t),label:"Service Type",filled:"",style:{width:"180px"}},null,8,["modelValue"])])):c("",!0),e.value.protocol&&e.value.type?(n(),m("div",E,[l(g,{label:"Submit",type:"submit",color:"primary",class:"q-pr-md"}),l(g,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])):c("",!0),e.value.namespace?(n(),m("div",L,[l(C,{title:"Services",rows:_.value,"row-key":"name",flat:"",bordered:""},{body:s(t=>[l(D,{props:t},{default:s(()=>[l(p,{key:"name",props:t},{default:s(()=>[u(i(t.row.name),1)]),_:2},1032,["props"]),l(p,{key:"type",props:t},{default:s(()=>[u(i(t.row.type),1)]),_:2},1032,["props"]),l(p,{key:"clusterIp",props:t},{default:s(()=>[u(i(t.row.clusterIp),1)]),_:2},1032,["props"]),l(p,{key:"externalIp",props:t},{default:s(()=>[u(i(t.row.externalIp),1)]),_:2},1032,["props"]),l(p,{key:"ports",props:t},{default:s(()=>[u(i(t.row.ports),1)]),_:2},1032,["props"]),l(p,{key:"createdAt",props:t},{default:s(()=>[u(i(t.row.createdAt)+" ",1),l(g,{icon:"delete",onClick:W=>S(t.row),color:"red-12",class:"q-ml-lg"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])])):c("",!0)]),_:1},8,["modelValue"])]),_:1}))}};export{O as default};
